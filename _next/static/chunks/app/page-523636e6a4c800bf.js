(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{428:(e,t,i)=>{Promise.resolve().then(i.bind(i,3792))},3792:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var o=i(5155),n=i(2115),l=i(4065),s=i(2502);function a(e){if(e>=6e4){let t=Math.floor(e/6e4),i=Math.floor(e%6e4/1e3);return"".concat(t," мин ").concat(i," сек")}return e>=1e3?"".concat((e/1e3).toFixed(2)," сек"):"".concat(e.toFixed(0)," мс")}s.t1.register(s.PP,s.kc,s.E8,s.hE,s.m_,s.s$,s.A6);let r=[5,10,20,50,100];function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;return e.length>t?e.slice(0,t-3)+"...":e}function c(){let[e,t]=(0,n.useState)(null),[i,s]=(0,n.useState)([]),[c,h]=(0,n.useState)([]),[x,p]=(0,n.useState)([]),[g,f]=(0,n.useState)(null),[u,b]=(0,n.useState)(!1),[y,m]=(0,n.useState)(1),[j,S]=(0,n.useState)(1),[w,k]=(0,n.useState)("fixtures"),[W,z]=(0,n.useState)(20),[N,v]=(0,n.useState)(20);function R(e){let[t,i,o,n,l,s]=e.split("	");return{dateTime:t,testRunId:i,fixtureName:o,testDisplayName:n,bimRequestName:l,elapsed:parseFloat(null==s?void 0:s.replace(/\r?\n|\r/g,""))}}let A=async()=>{if(e){b(!0);try{let t=(await e.text()).split("\n").filter(Boolean).map(R);p(t);let i={},o={};for(let e of t)"-"===e.testDisplayName?(i[e.fixtureName]||(i[e.fixtureName]={count:0,total:0}),i[e.fixtureName].count++,i[e.fixtureName].total+=e.elapsed):(o[e.testDisplayName]||(o[e.testDisplayName]={count:0,total:0}),o[e.testDisplayName].count++,o[e.testDisplayName].total+=e.elapsed);s(Object.entries(i).map(e=>{let[t,i]=e;return{fixture:t,total:i.total,count:i.count}})),h(Object.entries(o).map(e=>{let[t,i]=e;return{testDisplayName:t,total:i.total,count:i.count}})),f(null),m(1),S(1)}catch(e){f("Ошибка парсинга файла")}b(!1)}};return(0,o.jsxs)("div",{style:{minHeight:"100vh",background:"#f4f6fa",fontFamily:"Inter, sans-serif"},children:[(0,o.jsx)("header",{style:{background:"#1976d2",color:"#fff",padding:"24px 0",boxShadow:"0 2px 8px #0001"},children:(0,o.jsxs)("div",{style:{maxWidth:900,margin:"0 auto",padding:"0 24px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,o.jsx)("h1",{style:{fontSize:32,fontWeight:800,letterSpacing:1},children:"Test Stats Dashboard"}),(0,o.jsx)("span",{style:{fontSize:16,opacity:.85},children:"Аналитика производительности тестов"})]})}),(0,o.jsxs)("main",{style:{maxWidth:1600,margin:"40px auto",padding:24},children:[(0,o.jsxs)("section",{style:{background:"#fff",borderRadius:16,boxShadow:"0 2px 12px #0001",padding:32,marginBottom:32},children:[(0,o.jsx)("h2",{style:{fontSize:22,fontWeight:700,marginBottom:20,color:"#1976d2",letterSpacing:.5},children:"Загрузка файла статистики"}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:20,flexWrap:"wrap"},children:[(0,o.jsxs)("label",{style:{display:"inline-block",background:"#e3eaf6",color:"#1976d2",fontWeight:600,borderRadius:8,padding:"10px 22px",fontSize:16,cursor:"pointer",boxShadow:"0 1px 4px #0001",border:"2px solid #1976d2",transition:"background 0.2s, color 0.2s"},children:[e?"Выбрать другой файл":"Выбрать файл",(0,o.jsx)("input",{type:"file",accept:".txt,.log",onChange:e=>{e.target.files&&e.target.files[0]&&t(e.target.files[0])},style:{display:"none"}})]}),e&&(0,o.jsx)("span",{style:{color:"#222",fontSize:16,fontWeight:500,maxWidth:220,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),(0,o.jsx)("button",{onClick:A,disabled:!e||u,style:{background:e?"#1976d2":"#b0c4de",color:"#fff",border:"none",borderRadius:8,padding:"10px 24px",fontSize:16,fontWeight:600,cursor:e&&!u?"pointer":"not-allowed",boxShadow:"0 1px 4px #0001",transition:"background 0.2s"},children:u?"Загрузка...":"Загрузить"}),g&&(0,o.jsx)("span",{style:{color:"#d32f2f",fontWeight:500},children:g})]})]}),(0,o.jsxs)("div",{style:{maxWidth:1600,width:"100%",margin:"0 auto"},children:[(0,o.jsx)("div",{style:{width:"100%"},children:(0,o.jsxs)("div",{style:{display:"flex",gap:0,margin:"40px 0 24px 0",borderRadius:12,overflow:"hidden",boxShadow:"0 2px 12px #0001",background:"#fff",width:"100%"},children:[(0,o.jsx)("button",{onClick:()=>k("fixtures"),style:{flex:1,padding:"18px 0",fontSize:20,fontWeight:"fixtures"===w?700:500,background:"fixtures"===w?"#e3eaf6":"#fff",color:"fixtures"===w?"#1976d2":"#222",border:"none",cursor:"fixtures"===w?"default":"pointer",borderBottom:"fixtures"===w?"3px solid #1976d2":"3px solid transparent",transition:"background 0.2s"},children:"Фикстуры"}),(0,o.jsx)("button",{onClick:()=>k("tests"),style:{flex:1,padding:"18px 0",fontSize:20,fontWeight:"tests"===w?700:500,background:"tests"===w?"#e3eaf6":"#fff",color:"tests"===w?"#388e3c":"#222",border:"none",cursor:"tests"===w?"default":"pointer",borderBottom:"tests"===w?"3px solid #388e3c":"3px solid transparent",transition:"background 0.2s"},children:"Тесты"})]})}),(0,o.jsxs)("div",{className:"dashboard-card",style:{width:"100%",margin:0},children:["fixtures"===w&&i.length>0&&(()=>{let e=[...i].sort((e,t)=>t.total-e.total),t=Math.ceil(e.length/15),n=e.slice((y-1)*15,15*y),s=e.slice(0,W);return(0,o.jsxs)("section",{style:{background:"#fff",borderRadius:16,boxShadow:"0 2px 12px #0001",padding:32,marginBottom:32},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:24},children:[(0,o.jsx)("h2",{style:{fontSize:26,fontWeight:800,color:"#222",margin:0},children:"Суммарное время по фикстурам"}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,o.jsx)("span",{style:{fontSize:16,color:"#555"},children:"Топ"}),(0,o.jsx)("select",{value:W,onChange:e=>z(Number(e.target.value)),style:{fontSize:16,padding:"6px 18px",borderRadius:8,border:"1px solid #1976d2",color:"#1976d2",fontWeight:600,background:"#f4f6fa",outline:"none",cursor:"pointer",boxShadow:"0 1px 4px #0001",appearance:"none"},children:r.map(e=>(0,o.jsx)("option",{value:e,children:e},e))})]})]}),(0,o.jsx)("div",{style:{width:"100%",height:600,marginBottom:32},children:(0,o.jsx)(l.yP,{data:{labels:s.map(e=>e.fixture),datasets:[{label:"Сумма времени",data:s.map(e=>e.total),backgroundColor:"#1976d2",borderRadius:6,maxBarThickness:60}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!1},tooltip:{callbacks:{label:e=>a(e.parsed.x)}}},scales:{x:{title:{display:!0,text:"Время"},ticks:{callback:function(e){return a(Number(e))},font:{size:14}}},y:{title:{display:!0,text:"Фикстура"},ticks:{font:{size:14},callback:function(e,t,i){return d(String(this.getLabelForValue?this.getLabelForValue(Number(e)):e))}}}}}})}),(0,o.jsxs)("div",{className:"dashboard-table dashboard-table-scroll",style:{width:"100%",background:"#fff",borderRadius:8,boxShadow:"0 1px 4px #0001",marginTop:0},children:[(0,o.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:17,background:"#fff",tableLayout:"fixed"},children:[(0,o.jsxs)("colgroup",{children:[(0,o.jsx)("col",{style:{width:"60%"}}),(0,o.jsx)("col",{style:{width:"20%"}}),(0,o.jsx)("col",{style:{width:"20%"}})]}),(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{style:{background:"#e3eaf6",position:"sticky",top:0,zIndex:1},children:[(0,o.jsx)("th",{style:{padding:14,textAlign:"left",color:"#222",fontWeight:700,fontSize:17},children:"Фикстура"}),(0,o.jsx)("th",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:700,fontSize:17},children:"Сумма времени"}),(0,o.jsx)("th",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:700,fontSize:17},children:"Кол-во"})]})}),(0,o.jsx)("tbody",{children:n.map(e=>(0,o.jsxs)("tr",{style:{borderBottom:"1px solid #e3eaf6"},children:[(0,o.jsx)("td",{style:{padding:14,color:"#222",fontWeight:500,wordBreak:"break-all",whiteSpace:"normal",userSelect:"text"},children:e.fixture}),(0,o.jsx)("td",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:500,whiteSpace:"nowrap"},children:a(e.total)}),(0,o.jsx)("td",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:500,whiteSpace:"nowrap"},children:e.count})]},e.fixture))})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:16,margin:"22px 0 0 0"},children:[(0,o.jsx)("button",{onClick:()=>m(e=>Math.max(1,e-1)),disabled:1===y,style:{background:1===y?"#e3eaf6":"#1976d2",color:1===y?"#888":"#fff",border:"none",borderRadius:6,padding:"10px 24px",fontWeight:700,fontSize:17,cursor:1===y?"not-allowed":"pointer",transition:"background 0.2s"},children:"Назад"}),(0,o.jsxs)("span",{style:{fontWeight:700,color:"#222",fontSize:17},children:["Страница ",y," из ",t]}),(0,o.jsx)("button",{onClick:()=>m(e=>Math.min(t,e+1)),disabled:y===t,style:{background:y===t?"#e3eaf6":"#1976d2",color:y===t?"#888":"#fff",border:"none",borderRadius:6,padding:"10px 24px",fontWeight:700,fontSize:17,cursor:y===t?"not-allowed":"pointer",transition:"background 0.2s"},children:"Вперёд"})]})]})]})})(),"tests"===w&&c.length>0&&(()=>{let e=[...c].sort((e,t)=>t.total-e.total),t=Math.ceil(e.length/15),i=e.slice((j-1)*15,15*j),n=e.slice(0,N);return(0,o.jsxs)("section",{style:{background:"#fff",borderRadius:16,boxShadow:"0 2px 12px #0001",padding:32,marginBottom:32},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:24},children:[(0,o.jsx)("h2",{style:{fontSize:26,fontWeight:800,color:"#222",margin:0},children:"Суммарное время по тестам"}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,o.jsx)("span",{style:{fontSize:16,color:"#555"},children:"Топ"}),(0,o.jsx)("select",{value:N,onChange:e=>v(Number(e.target.value)),style:{fontSize:16,padding:"6px 18px",borderRadius:8,border:"1px solid #388e3c",color:"#388e3c",fontWeight:600,background:"#f4f6fa",outline:"none",cursor:"pointer",boxShadow:"0 1px 4px #0001",appearance:"none"},children:r.map(e=>(0,o.jsx)("option",{value:e,children:e},e))})]})]}),(0,o.jsx)("div",{style:{width:"100%",height:600,marginBottom:32},children:(0,o.jsx)(l.yP,{data:{labels:n.map(e=>e.testDisplayName),datasets:[{label:"Сумма времени",data:n.map(e=>e.total),backgroundColor:"#388e3c",borderRadius:6,maxBarThickness:60}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!1},tooltip:{callbacks:{label:e=>a(e.parsed.x)}}},scales:{x:{title:{display:!0,text:"Время"},ticks:{callback:function(e){return a(Number(e))},font:{size:14}}},y:{title:{display:!0,text:"Тест"},ticks:{font:{size:14},callback:function(e,t,i){return d(String(this.getLabelForValue?this.getLabelForValue(Number(e)):e))}}}}}})}),(0,o.jsxs)("div",{className:"dashboard-table dashboard-table-scroll",style:{width:"100%",background:"#fff",borderRadius:8,boxShadow:"0 1px 4px #0001",marginTop:0},children:[(0,o.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:17,background:"#fff",tableLayout:"fixed"},children:[(0,o.jsxs)("colgroup",{children:[(0,o.jsx)("col",{style:{width:"60%"}}),(0,o.jsx)("col",{style:{width:"20%"}}),(0,o.jsx)("col",{style:{width:"20%"}})]}),(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{style:{background:"#e3eaf6",position:"sticky",top:0,zIndex:1},children:[(0,o.jsx)("th",{style:{padding:14,textAlign:"left",color:"#222",fontWeight:700,fontSize:17},children:"Тест"}),(0,o.jsx)("th",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:700,fontSize:17},children:"Сумма времени"}),(0,o.jsx)("th",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:700,fontSize:17},children:"Кол-во"})]})}),(0,o.jsx)("tbody",{children:i.map(e=>(0,o.jsxs)("tr",{style:{borderBottom:"1px solid #e3eaf6"},children:[(0,o.jsx)("td",{style:{padding:14,color:"#222",fontWeight:500,wordBreak:"break-all",whiteSpace:"normal",userSelect:"text"},children:e.testDisplayName}),(0,o.jsx)("td",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:500,whiteSpace:"nowrap"},children:a(e.total)}),(0,o.jsx)("td",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:500,whiteSpace:"nowrap"},children:e.count})]},e.testDisplayName))})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:16,margin:"22px 0 0 0"},children:[(0,o.jsx)("button",{onClick:()=>S(e=>Math.max(1,e-1)),disabled:1===j,style:{background:1===j?"#e3eaf6":"#388e3c",color:1===j?"#888":"#fff",border:"none",borderRadius:6,padding:"10px 24px",fontWeight:700,fontSize:17,cursor:1===j?"not-allowed":"pointer",transition:"background 0.2s"},children:"Назад"}),(0,o.jsxs)("span",{style:{fontWeight:700,color:"#222",fontSize:17},children:["Страница ",j," из ",t]}),(0,o.jsx)("button",{onClick:()=>S(e=>Math.min(t,e+1)),disabled:j===t,style:{background:j===t?"#e3eaf6":"#388e3c",color:j===t?"#888":"#fff",border:"none",borderRadius:6,padding:"10px 24px",fontWeight:700,fontSize:17,cursor:j===t?"not-allowed":"pointer",transition:"background 0.2s"},children:"Вперёд"})]})]})]})})()]})]}),x.length>0&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("section",{style:{background:"#fff",borderRadius:16,boxShadow:"0 2px 12px #0001",padding:32,margin:"40px 0 32px 0",maxWidth:1600,width:"100%"},children:[(0,o.jsx)("h2",{style:{fontSize:22,fontWeight:800,marginBottom:24,color:"#b71c1c"},children:"Топ-10 самых медленных запросов (bimRequestName)"}),(0,o.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:17,background:"#fff",tableLayout:"fixed"},children:[(0,o.jsxs)("colgroup",{children:[(0,o.jsx)("col",{style:{width:"60%"}}),(0,o.jsx)("col",{style:{width:"20%"}}),(0,o.jsx)("col",{style:{width:"20%"}})]}),(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{style:{background:"#e3eaf6"},children:[(0,o.jsx)("th",{style:{padding:14,textAlign:"left",color:"#222",fontWeight:700,fontSize:17},children:"Запрос"}),(0,o.jsx)("th",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:700,fontSize:17},children:"Среднее время"}),(0,o.jsx)("th",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:700,fontSize:17},children:"Кол-во"})]})}),(0,o.jsx)("tbody",{children:Object.entries(x.reduce((e,t)=>(t.bimRequestName&&(e[t.bimRequestName]||(e[t.bimRequestName]={total:0,count:0}),e[t.bimRequestName].total+=t.elapsed,e[t.bimRequestName].count++),e),{})).map(e=>{let[t,i]=e;return{bimRequestName:t,avg:i.total/i.count,count:i.count}}).sort((e,t)=>t.avg-e.avg).slice(0,10).map(e=>(0,o.jsxs)("tr",{style:{borderBottom:"1px solid #e3eaf6"},children:[(0,o.jsx)("td",{style:{padding:14,color:"#222",fontWeight:500,wordBreak:"break-all",whiteSpace:"normal",userSelect:"text"},children:e.bimRequestName}),(0,o.jsx)("td",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:500,whiteSpace:"nowrap"},children:a(e.avg)}),(0,o.jsx)("td",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:500,whiteSpace:"nowrap"},children:e.count})]},e.bimRequestName))})]})]}),(0,o.jsxs)("section",{style:{background:"#fff",borderRadius:16,boxShadow:"0 2px 12px #0001",padding:32,margin:"40px 0 32px 0",maxWidth:1600,width:"100%"},children:[(0,o.jsx)("h2",{style:{fontSize:22,fontWeight:800,marginBottom:24,color:"#1976d2"},children:"Топ-10 самых частых запросов (bimRequestName)"}),(0,o.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:17,background:"#fff",tableLayout:"fixed"},children:[(0,o.jsxs)("colgroup",{children:[(0,o.jsx)("col",{style:{width:"60%"}}),(0,o.jsx)("col",{style:{width:"20%"}}),(0,o.jsx)("col",{style:{width:"20%"}})]}),(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{style:{background:"#e3eaf6"},children:[(0,o.jsx)("th",{style:{padding:14,textAlign:"left",color:"#222",fontWeight:700,fontSize:17},children:"Запрос"}),(0,o.jsx)("th",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:700,fontSize:17},children:"Среднее время"}),(0,o.jsx)("th",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:700,fontSize:17},children:"Кол-во"})]})}),(0,o.jsx)("tbody",{children:Object.entries(x.reduce((e,t)=>(t.bimRequestName&&(e[t.bimRequestName]||(e[t.bimRequestName]={total:0,count:0}),e[t.bimRequestName].total+=t.elapsed,e[t.bimRequestName].count++),e),{})).map(e=>{let[t,i]=e;return{bimRequestName:t,avg:i.total/i.count,count:i.count}}).sort((e,t)=>t.count-e.count).slice(0,10).map(e=>(0,o.jsxs)("tr",{style:{borderBottom:"1px solid #e3eaf6"},children:[(0,o.jsx)("td",{style:{padding:14,color:"#222",fontWeight:500,wordBreak:"break-all",whiteSpace:"normal",userSelect:"text"},children:e.bimRequestName}),(0,o.jsx)("td",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:500,whiteSpace:"nowrap"},children:a(e.avg)}),(0,o.jsx)("td",{style:{padding:14,textAlign:"right",color:"#222",fontWeight:500,whiteSpace:"nowrap"},children:e.count})]},e.bimRequestName))})]})]})]}),(0,o.jsxs)("section",{style:{background:"#fff",borderRadius:16,boxShadow:"0 2px 12px #0001",padding:32,marginBottom:32,color:"#aaa",textAlign:"center"},children:[(0,o.jsx)("h2",{style:{fontSize:20,fontWeight:600},children:"Больше аналитики скоро!"}),(0,o.jsx)("p",{children:"Здесь появятся топ-10 медленных тестов, распределения по bimRequestName, фильтры и другие графики."})]})]}),(0,o.jsxs)("footer",{style:{textAlign:"center",color:"#888",padding:24,fontSize:15},children:["\xa9 ",new Date().getFullYear()," Test Stats Dashboard"]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[647,579,441,684,358],()=>t(428)),_N_E=e.O()}]);